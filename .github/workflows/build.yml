name: Build APK

on:
  push:
    branches:
      - master

jobs:
  build:
    name: üõ† –°–±–æ—Ä–∫–∞ APK
    runs-on: ubuntu-latest

    steps:
    - name: üîΩ –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
      uses: actions/checkout@v2

    - name: ‚öôÔ∏è –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
      run: |
        sudo apt update
        sudo apt install -y build-essential git zip unzip openjdk-17-jdk python3 python3-pip libffi-dev libssl-dev
        python3 -m pip install --upgrade pip
        pip install cython
        pip install buildozer

    - name: üß∞ –°–∫–∞—á–∏–≤–∞–µ–º –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º Buildozer
      run: |
        sudo apt install -y libsqlite3-dev zlib1g-dev
        buildozer init || true

    - name: üì¶ –°–±–æ—Ä–∫–∞ APK
      run: |
        buildozer -v android debug

    - name: üì§ –°–æ—Ö—Ä–∞–Ω—è–µ–º APK –∫–∞–∫ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç
      uses: actions/upload-artifact@v3
      with:
        name: sklad_tavrovo2.apk
        path: bin/*.apk
